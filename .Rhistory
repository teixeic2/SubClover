file %>%
group_by(Subspecie) %>%
summarise_each(funs(mean, sd)) %>%
ggplot(aes(x=Subspecie, y=X.RdLeaves_mean, fill=Subspecie)) +
geom_bar(position = position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=X.RdLeaves_mean-X.RdLeaves_sd/2,
ymax=X.RdLeaves_mean+X.RdLeaves_sd/2),
width=0.25)   +
scale_fill_manual(values=cbPalette) +
theme_grey(base_size = 16)+
theme(axis.text.x=element_text(angle = +90, hjust = 0))
ggsave(file="GHPercentageLeaves1.tiff", dpi=300)
#Here Analysis of cultivar
file %>%
#filter(Cultivar == "Antas") %>%
group_by(Cv) %>%
summarise_each(funs(mean, sd)) %>%
mutate(Cv = factor(Cv,levels =
Cv[order(X.RdLeaves_mean)])) %>%
ggplot(aes(x=Cv, y=X.RdLeaves_mean, fill=Cv)) +
geom_bar(position = position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=X.RdLeaves_mean-X.RdLeaves_sd/2,
ymax=X.RdLeaves_mean+X.RdLeaves_sd/2),
width=0.25)   +
scale_fill_manual(values=cbPalette) +
theme_grey(base_size = 22)+
theme(axis.text.x=element_text(angle = +90, hjust = 0))+
ylab("RedLeaves")
ggsave(file="PlotsPercentage_Cultivar3.tiff", dpi=300)
#data transformation
file$SQR<- sqrt(file$X.RdLeaves)
head(file)
#histogram
ggplot(data=file, aes(SQR)) +
geom_histogram()
#normality test
shapiro.test(file$SQR)
#QQplot
var<-file$SQR
qqnorm(var)
qqline(var, col = 2)
qqplot(var, rt(300, df = 5))
#AnovaLog analysis of transformed sqr
file$Block <- as.factor(file$Block )
anovaSQR<-aov(file$SQR~file$Cv+file$Block)
summary(anovaSQR)
TukeyHSD(anovaSQR)
#Means separation of SQR transformed data by Cultivar
(LSD.test(anovaSQR, "file$Cv", alpha= 0.05, p.adj="none"))
#Anova and Means separation of log transformed data by Subspecies
file$Block <- as.factor(file$Block )
anovaSQR <- aov(file$SQR ~file$Subspecie+file$Block)
summary(anovaSQR)
TukeyHSD(anovaSQR)
(LSD.test(anovaSQR, "file$Subspecie", alpha= 0.05, p.adj="none"))
summary (anovaSQR)
#Analysing variable Red Colour intensity
#barplot
#The palette with grey:
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#D55E00", "#0072B2","#999999", "#E69F00", "#56B4E9", "#009E73", "#D55E00", "#0072B2","#56B4E9", "#009E73")
#Here Analysis of cultivar
file %>%
#filter(Cultivar == "Antas") %>%
group_by(Cv) %>%
summarise_each(funs(mean, sd)) %>%
mutate(Cv = factor(Cv,levels =
Cv[order(RedIntensity_mean)])) %>%
ggplot(aes(x=Cv, y=RedIntensity_mean, fill=Cv)) +
geom_bar(position = position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=RedIntensity_mean-RedIntensity_sd/2,
ymax=RedIntensity_mean+RedIntensity_sd/2),
width=0.25)   +
scale_fill_manual(values=cbPalette) +
theme_grey(base_size = 22)+
theme(axis.text.x=element_text(angle = +90, hjust = 0))+
ylab("RedIntensity")
head(file)
```{r LoadLibraries }
library(tidyr)
library (dplyr)
library (ggplot2)
library (lubridate)
library (reshape2)
```
REad table Notepad file: Temperatures Cold Test FieldExp_1
```{r, readFile}
setwd("C:\\Users\\Ed\\Documents\\Subclovergit\\Temperatures Cold test")
getwd()
#create file
df_Tone <- read.table("FieldExp_1.txt",header=TRUE)
df_Tone
head(df_Tone)
summary (df_Tone)
tail(df_Tone)
```
Create Graph : convert date into dmy
```{r createFileExpOne}
df_Tone$Date <- dmy(df_Tone$Date)
#df_Tone_long <- melt(df_Tone, id="Date")
df_Tone %>%
ggplot(aes(x=Date)) +
geom_line(aes(y= AverageofMeanTt, colour = "MeanT"))+
geom_line(aes(y = AverageofTm, colour = "MinT"))+
geom_line(aes(y = AverageofTx, colour = "MaxT"))+
ylab("Temperature")+
theme_bw()+
ggtitle("Experiment1 Daily Temperature (oC) ")
```
Calculate TT
```{r calculateTT}
Tb <-0 #base temperature oC
df_Tone <- df_Tone %>%
mutate(TT=AverageofMeanTt-Tb)
head(df_Tone)
```
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
---
title: "Flowering 6CV"
author: "CT"
date: "Thursday, December 31, 2015"
output: html_document
---
```{r loadLibraries}
library(tidyr)
library (dplyr)
library (ggplot2)
library(agricolae)
library(knitr)
library (lubridate)
```
```{r loadFile}
setwd("C:\\Users\\Ed\\Documents\\Subclovergit")
getwd()
#create file
df_flower <- read.table("F_Flower_SB_PhenologyData.txt",header=TRUE)
colnames(df_flower)[1] <- "Date" # fix bug of extra characters in name
# convert to date format
df_flower <- df_flower %>%
mutate(Date=dmy(Date))
str(df_flower)
df_flower
head(df_flower )
summary(df_flower )
names(df_flower)
```
Analysis of sowing date and cultivars for Bud considering Date
```{rGraphBoxPlotBud}
# df_flower$Date <- dmy(df_flower$Date)
head(df_flower)
df_flower %>%
group_by(DAS,Date, Cultivar,SowTreat,Variable)%>%
summarise_each(funs(mean)) %>%
select(Variable,Percent, Cultivar,Date,SowTreat)%>%
filter(Variable == "Bud") %>%
ggplot(aes(x=Date, y=Percent)) +
#geom_bar(shape=1, stat="identity")
geom_line(aes(colour=Cultivar)) +
facet_grid(SowTreat~Cultivar, scales = "free")+
geom_abline(intercept = 50, slope = 0)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#scale_x_continuous(breaks=c(2,3,4,5,6,7,8,9,10,11), labels=c("Fe","Mr","Ap","Ma","Ju","Jul","Au","Se","Oc","No"))
```
Analysis of Sowing dates and variables (from bud to bur4) considering DAS
```{r GraphSowingDateAndVariable}
df_flower %>%
mutate(Variable =
factor(Variable,levels = c("Bud","Early","Open",
"Petal","Bur1","Bur2","Bur3","Bur4" ))) %>%
group_by(DAS,Cultivar,SowTreat,Variable) %>%
summarise_each(funs(mean)) %>%
select(Variable,Percent, Cultivar,DAS,SowTreat) %>%
filter(Cultivar == "Leura" | Cultivar =="Monti") %>%
ggplot(aes(x=DAS, y=Percent)) +
#geom_bar(shape=1, stat="identity")
geom_line(aes(colour=Cultivar)) +
facet_grid(SowTreat~Variable, scales = "free") +
geom_abline(intercept = 50, slope = 0)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
Join Thermal Sum data.
```{r join ThermalSum data}
#create file
df_TTSum <- read.table("ThermalSum.txt",header=TRUE)
#df_TTSum$Date <- ymd(df_TTSum$Date)
df_TTSum
head(df_TTSum)
summary(df_TTSum  )
names(df_TTSum)
str(df_TTSum$Date)
tail(df_TTSum)
tail(df_flower)
# convert to date format
df_TTSum <- df_TTSum %>%
mutate(Date=ymd(Date))
```
Merge two df : TTSum and Flowering
```{r MergeTTSumDate}
#merge two data frames by ID
df_flower <- merge(df_flower,df_TTSum,by="Date")
head(df_flower)
summary(df_flower )
#tidy up dataframe
names(df_flower)[1] <- "DateMeasure"
names(df_flower)[15] <- "TTMeasure"
```
```{r mergeTTSowDate,include=FALSE}
df_TTSow <-read.table("TTSowDate.txt", header=TRUE)
df_TTSow$MeanAirT<-NULL
names(df_TTSow)[3]
df_flower <- merge(df_flower,df_TTSow, by="SowTreat" )
head(df_flower)
#tidy up names
names(df_flower)[17] <- "TTSow"
```
```{r Calc_TT_afterSow}
df_flower$TTAS <- df_flower$TTMeasure-df_flower$TTSow
df_flower %>%
mutate(Variable =
factor(Variable,levels = c("Bud","Early","Open",
"Petal","Bur1","Bur2","Bur3","Bur4" ))) %>%
group_by(TTAS,Cultivar,SowTreat,Variable) %>%
summarise_each(funs(mean)) %>%
select(Variable,Percent, Cultivar,TTAS,SowTreat) %>%
#filter(Cultivar == "Monti") %>%
filter(Variable == "Bud") %>%
ggplot(aes(x=TTAS, y=Percent)) +
geom_line(aes(colour=Cultivar)) +
facet_grid(SowTreat~Cultivar, scales = "free") +
geom_abline(intercept = 50, slope = 0)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#by variable
df_flower %>%
mutate(Variable =
factor(Variable,levels = c("Bud","Early","Open",
"Petal","Bur1","Bur2","Bur3","Bur4" ))) %>%
group_by(TTAS,Cultivar,SowTreat,Variable) %>%
summarise_each(funs(mean)) %>%
select(Variable,Percent, Cultivar,TTAS,SowTreat) %>%
filter(Cultivar == "Monti" | Cultivar == "Leura" ) %>%
#filter(Variable == "Bud") %>%
ggplot(aes(x=TTAS, y=Percent)) +
geom_line(aes(colour=Cultivar)) +
facet_grid(SowTreat~Variable, scales = "free") +
geom_abline(intercept = 50, slope = 0)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
```
```{r proxie50%intercept}
df_flower %>%
```
df <- data.frame(x= c(0,25,50,75,100)),y=c(0,1,2 3,4)
df <- data.frame(x= c(0,25,50,75,100))y=c(0,1,2 3,4)
df <- data.frame(x= c(0,25,50,75,100), y=c(0,1,2 3,4))
x= c(0,25,50,75,100)
y=c(0,1,2 3,4)
df <- data.frame(x,y)
#df_flower %>%
x= c(0,25,50,75,100)
y= c(0,1,2 3,4)
df <- data.frame(x,y)
y <- c(0,1,2 3,4)
#df_flower %>%
x <- c(0,25,50,75,100)
y <- c(0,1,2,3,4)
df <- data.frame(x,y)
approx(df$x, df$y, xout = 30)
#df_flower %>%
x <- c(0,25,65,75,100)
y <- c(0,1,2,3,4)
df <- data.frame(x,y)
approx(df$x, df$y, xout = 50)
#df_flower %>%
x <- c(0,25,65,75,100)
y <- c(0,1,2,3,4)
df <- data.frame(x,y)
approx(df$x, df$y, yout = 1.5)
#df_flower %>%
x <- c(0,25,65,75,100)
y <- c(0,1,2,3,4)
df <- data.frame(x,y)
approx(df$x, df$y, xout = 20)
head (df_flower)
source('~/.active-rstudio-document', echo=TRUE)
head (df_flower)
df_flower %>%
group_by(Cultivar,SowTreat,Variable)%>%
mutate (tutu=approx(Percent,TTAS , xout = 50))
df_flower %>%
group_by(Cultivar,SowTreat,Variable)%>%
summarise(tutu=approx(Percent,TTAS , xout = 50))
df_flower %>%
group_by(Cultivar,SowTreat,Variable)%>%
dplyr::select(TTAS,Percent)%>%
summarise(funs(mean))
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable)
group_by(Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable)
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable)
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise(funs(mean))
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))  %>%
mutate(tutu=approx(avP,avTT , xout = 50))
df_flower
head(df_flower)
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))  %>%
mutate(tutu=approx(avP,avTT , xout = 50))
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
head
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable) %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower %>%
dplyr::select(TTAS,Percent,Cultivar,SowTreat,Variable,DateMeasure) %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower50 <- df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower50 %>%
filter(Variable=="Bud", Cultivar=="Leura",SowTreat=="S1" )
tutu=approx(df_flower50$avP,df_flower50$avTT , xout = 50)
tutu
df_flower50 <- df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower50 %>%
filter(Variable=="Bud", Cultivar=="Monti",SowTreat=="S1" )
#interpolate
tutu=approx(df_flower50$avP,df_flower50$avTT , xout = 50)
df_flower50 <- df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
df_flower50 %>%
filter(Variable=="Bud", Cultivar=="Monti",SowTreat=="S1" )
#interpolate
tutu=approx(df_flower50$avP,df_flower50$avTT , xout = 50)
tutu
df_flower50 <- df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS)) %>%
mutate(approx(df_flower50$avP,df_flower50$avTT , xout = 50))
```{r proxie50%intercept}
df_flower50 <- df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
w <- df_flower50 %>%
filter(Variable=="Bud", Cultivar=="Monti",SowTreat=="S1" )
#interpolate
tutu = approx(w$avP,w$avTT , xout = 50)
tutu
df_flower50 <- df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
w <- df_flower50 %>%
filter(Variable=="Bud", Cultivar=="Leura",SowTreat=="S1" )
#interpolate
tutu = approx(w$avP,w$avTT , xout = 50)
tutu
source('~/.active-rstudio-document', echo=TRUE)
df_flower %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise(funs(mean))
df_flower %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise(funs(max))
df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS)) %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise(funs(max))
df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS)) %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise_each(funs(max))
df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS)) %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise_each(funs(approx(avP,avTT,50)))
df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS)) %>%
group_by(Cultivar,SowTreat,Variable) %>%
summarise_each(funs(approx(avP,avTT,xout=50)))
df_flower50 <- df_flower %>%
group_by(Cultivar,SowTreat,Variable, DateMeasure) %>%
summarise(avP= mean(Percent),avTT= mean(TTAS))
w <- df_flower50 %>%
filter(Variable=="Bud", Cultivar=="Leura",SowTreat=="S1" )
#interpolate
tutu <- approx(w$avP,w$avTT , xout = 50)
tutu
cv <- unique(df_flower50$Cultivar)
var <- unique(df_flower50$Variable)
sd <- unique(df_flower50$DateMeasure)
# create loop to calculate all
cv <- unique(df_flower50$Cultivar)
var <- unique(df_flower50$Variable)
sow <- unique(df_flower50$DateMeasure)
for(cv in 1: length(cv)) {
for(var in 1:length(var)){
for(sd in 1:length(sow)){
print(cv,var, sd)
}
}
}
for(i in 1:length(cv)) {
for(j in 1:length(var)){
for(k in 1:length(sow)){
print(cv[i],var[j], sow[k])
}
}
}
# create loop to calculate all
cv <- unique(df_flower50$Cultivar)
var <- unique(df_flower50$Variable)
sow <- unique(df_flower50$DateMeasure)
for(i in 1:length(cv)) {
for(j in 1:length(var)){
for(k in 1:length(sow)){
print(cv[i],var[j], sow[k])
}
}
}
cv
var
sow
# create loop to calculate all
cv <- unique(df_flower50$Cultivar)
var <- unique(df_flower50$Variable)
sow <- unique(df_flower50$SowTreat)
for(i in 1:length(cv)) {
for(j in 1:length(var)){
for(k in 1:length(sow)){
print(cv[i],var[j], sow[k])
}
}
}
cv <- unique(df_flower50$Cultivar)
var <- unique(df_flower50$Variable)
sow <- unique(df_flower50$SowTreat)
cv
# create loop to calculate all
cv <- unique(df_flower50$Cultivar)
var <- unique(df_flower50$Variable)
sow <- unique(df_flower50$SowTreat)
for(i in 1:length(cv)) {
for(j in 1:length(var)){
for(k in 1:length(sow)){
print(paste0(cv[i],var[j], sow[k]))
}
}
}
source('~/.active-rstudio-document', echo=TRUE)
library(tidyr)
library (dplyr)
library (ggplot2)
library(agricolae)
library(knitr)
library (lubridate)
setwd("C:\\Users\\Ed\\Documents\\Subclovergit")
getwd()
#create file
df_seed <- read.table("HardseedsData.txt",header=TRUE)
colnames(df_seed)[1] <- "Date" # fix bug of extra characters in name
# convert to date format
#df_seed <- df_seed %>%
#mutate(Date=dmy(Date),SowingD=dmy(SowingD),
#      Percent=(S1+S2+S3+S4+S5)/5*100)
str(df_seed)
head(df_seed)
summary(df_seed)
library(knitr)
library(tidyr)
library (dplyr)
library (ggplot2)
library(agricolae)
library(knitr)
library (lubridate)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
